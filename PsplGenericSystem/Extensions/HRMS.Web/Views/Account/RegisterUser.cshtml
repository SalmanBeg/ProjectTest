@model HRMS.Web.ViewModels.RegisterFormModel

<!DOCTYPE html>
<html class="bg-black">
<head>
    <meta charset="UTF-8">
    <title>AdminLTE | Registration Page</title>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
    <!-- bootstrap 3.0.2 -->
    <link href="~/Content/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <!-- font Awesome -->
    <link href="~/Content/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <!-- Theme style -->
    <link href="~/Content/css/AdminLTE.css" rel="stylesheet" type="text/css" />
    <!-- Customized style -->
    <link href="~/Content/HRMSStylesheet.css" rel="stylesheet" />
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
          <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
    <!-- jQuery 2.0.2 -->
    @Scripts.Render("~/bundles/jquery")
    @*<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>*@
    <!-- Bootstrap -->
    <script src="../Scripts/bootstrap.min.js" type="text/javascript"></script>
    
    <!-- Input masks for controls -->
    <script src="../Scripts/plugins/input-mask/jquery.inputmask.js" type="text/javascript"></script>

    <script src="../Scripts/plugins/input-mask/jquery.inputmask.numeric.extensions.js" type="text/javascript"></script>

    <script src="../Scripts/plugins/input-mask/jquery.inputmask.phone.extensions.js" type="text/javascript"></script>


    <!-- For Validations -->
    @Scripts.Render("~/bundles/validate")

    <style type="text/css">
        .tooltip-inner
        {
            max-width: 300px;
            padding: 0;
        }

        .tooltip-alert
        {
            padding: 8px 10px;
            font-weight: bolder;
            color: #A94442;
        }
    </style>
</head>
<body class="bg-black">

    <div class="form-box" id="login-box">
        <div class="header">Register Account</div>
        @using (Html.BeginForm("RegisterUser", "Account", FormMethod.Post, new { @id = "RegisterForm", @class = "form-horizontal group-border-dashed" }))
        {
            <div class="body bg-gray">


                <div class="col-sm-12" style="margin-bottom: 20px; border-bottom: 1px solid #ccc; padding: 0px;">
                    <h3 style="margin-top: 0px; color: #f58500;">Company Details</h3>
                    @Html.ValidationSummary(true)
                </div>

                <div class="form-group">
                    <label class="col-sm-3 control-label">Company Name <span class="red-star">*</span></label>
                    <div class="col-sm-9">
                        @Html.TextBoxFor(m => m.CompanyName, new { @class = "form-control" })
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">Address 1 <span class="red-star">*</span></label>
                    <div class="col-sm-9">
                        @Html.TextBoxFor(m => m.Address1, new { @class = "form-control" })
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">Address 2</label>
                    <div class="col-sm-9">
                        @Html.TextBoxFor(m => m.Address2, new { @class = "form-control" })
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">Zip/Postal Code <span class="red-star">*</span></label>
                    <div class="col-sm-9">
                        @Html.TextBoxFor(m => m.ZIP, new { @class = "form-control zipmask" })
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">City <span class="red-star">*</span></label>
                    <div class="col-sm-9">
                        @Html.TextBoxFor(m => m.City, new { @class = "form-control" })
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">Country <span class="red-star">*</span></label>
                    <div class="col-sm-9">
                        @Html.DropDownListFor(m => m.CountryId, new SelectList(Model.Country, "CountryRegionId", "Name"), "--Select--", new Dictionary<string, Object> { { "class", "form-control" }, { "data-val-1", "CountryRegionCode" }, { "id", "drpdwncountry" } })
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">State/Province <span class="red-star">*</span></label>
                    <div class="col-sm-9">
                        @Html.DropDownListFor(m => m.StateId, new SelectList(Model.State, "StateProvinceId", "Name"), "--Select--", new { @class = "form-control", @id = "drpdwnstate" })
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-3 control-label">Phone <span class="red-star">*</span></label>
                    <div class="col-sm-9">
                        @Html.TextBoxFor(m => m.Phone, new { @class = "form-control phonemask" })
                    </div>
                </div>


                <div class="col-sm-12" style="margin-bottom: 20px; border-bottom: 1px solid #ccc; padding: 0px;">
                    <h3 style="margin-top: 20px; color: #f58500;">Account Access</h3>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">First Name <span class="red-star">*</span> </label>
                    <div class="col-sm-9">
                        @Html.TextBoxFor(m => m.FirstName, new { @class = "form-control" })
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">Last Name <span class="red-star">*</span> </label>
                    <div class="col-sm-9">
                        @Html.TextBoxFor(m => m.LastName, new { @class = "form-control" })
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">Email <span class="red-star">*</span> </label>
                    <div class="col-sm-9">
                        @Html.TextBoxFor(m => m.Email, new { @class = "form-control" })
                        @Html.ValidationMessageFor(m => m.Email)
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">User Name <span class="red-star">*</span> </label>
                    <div class="col-sm-9">
                        @Html.TextBoxFor(m => m.UserName, new { @class = "form-control" })
                        @Html.ValidationMessageFor(m => m.UserName)
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">Password  <span class="red-star">*</span></label>
                    <div class="col-sm-9">
                        @Html.PasswordFor(m => m.Password, new { @class = "form-control" })
                    </div>
                </div>


                <div class="form-group">
                    <label class="col-sm-3 control-label">Confirm Password  <span class="red-star">*</span></label>
                    <div class="controls col-sm-9">
                        @Html.PasswordFor(m => m.ConfirmPassword, new { @class = "form-control" })
                    </div>
                </div>
                @* <div class="form-group">
                    <label class="col-sm-3 control-label">&nbsp;</label>
                    <div class="col-sm-9">
                        <button type="submit" class="btn btn-warning btn-rad">Create Account</button>
                    </div>
                </div>*@
            </div>
            <div class="footer">
                <div class="form-group">
                    <div class="col-sm-12">
                        <label id="lblMessage" class="label-danger" style="display: none;">Account cannot be created, Please try again.</label>
                        <button id="btnCreateAccount" type="submit" class="btn bg-olive btn-block">Create Account</button>
                        <img src="~/Content/ajax-loader.gif" id="imgload" style="display:none" />
                    </div>
                </div>
                @Html.ActionLink("I already have an account", "Login", "Account", "", new { @class = "text-center" })

            </div>
        }
        @*  <div class="margin text-center">
            <span>Register using social networks</span>
            <br />
            <button class="btn bg-light-blue btn-circle"><i class="fa fa-facebook"></i></button>
            <button class="btn bg-aqua btn-circle"><i class="fa fa-twitter"></i></button>
            <button class="btn bg-red btn-circle"><i class="fa fa-google-plus"></i></button>

        </div>*@
    </div>

    <!-- new COMPANY REGISTRATION INTIMATION dialog-->
    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" id="RegistrationDialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" id="btnclose_dialog_default" class="close" aria-hidden="true">&times;</button>
                    <h4 class="modal-title label-success" id="myModalLabel">Account registration successful</h4>
                </div>
                <div class="modal-body">
                    @Html.ActionLink("Click here to navigate to Login screen", "Login", "Account")
                </div>

            </div>
        </div>
    </div>
    <!--new field description dialog End-->
    <script type="text/javascript">
        $(document).ready(function () {

            //applying masks to controls
            $(".phonemask").inputmask("mask", { "mask": "(999) 999-9999" });
            $(".ssnmask").inputmask("mask", { "mask": "999-99-9999" });
            $(".zipmask").inputmask({ mask: "99999[-9999]", greedy: false });

            var classes = { groupIdentifier: ".form-group", error: 'has-error', success: null };//success: 'has-success' 
            function updateClasses(inputElement, toAdd, toRemove) {
                var group = inputElement.closest(classes.groupIdentifier);
                if (group.length > 0) {
                    group.addClass(toAdd).removeClass(toRemove);
                }
            }
            function onError(inputElement, message) {
                updateClasses(inputElement, classes.error, classes.success);

                var options = { html: true, title: '<div class="tooltip-alert alert-danger">' + message + '</div>' };
                inputElement.tooltip("destroy")
                    .addClass("error")
                    .tooltip(options);
            }
            function onSuccess(inputElement) {
                updateClasses(inputElement, classes.success, classes.error);
                inputElement.tooltip("destroy");
            }

            function onValidated(errorMap, errorList) {
                $.each(errorList, function () {
                    onError($(this.element), this.message);
                });

                if (this.settings.success) {
                    $.each(this.successList, function () {
                        onSuccess($(this));
                    });
                }
            }
            //setting validations

            $('form').each(function () {
                var validator = $(this).data('validator');
                validator.settings.showErrors = onValidated;
            });

            //creating account
            $("#btnCreateAccount").click(function (e) {
                showloader();
                e.stopPropagation();
                e.preventDefault();
              
                var baseurl = '@System.Configuration.ConfigurationManager.AppSettings["BaseURL"]';
                if ($("#RegisterForm").valid()) { //if you use validation
                    $.ajax({
                        url: baseurl + "Account/RegisterUser",
                        type: $("#RegisterForm").attr('method'),
                        data: $("#RegisterForm").serialize(),
                        success: function (data) {
                            if (data == 'True') {
                                hideloader();
                                $("#RegistrationDialog").modal('show');
                                return true;
                            } else {
                                hideloader();
                                $("#lblMessage").show();
                            }
                        }
                    });
                }
                return false;
            });
        });

        $("#drpdwncountry").change(function () {

            var countryregionId = $(this).val();
            if (countryregionId != null && countryregionId != "") {
                var baseurl1 = "../Account/FillStatesByCountryId";
                $.getJSON(baseurl1, { CountryRegionId: countryregionId }, function (countryData) {
                    var select = $('#drpdwnstate');
                    select.html('');
                    $.each(countryData, function (index, itemData) {
                        select.append($('<option/>', {
                            value: itemData.StateProvinceID,
                            text: itemData.Name,
                        }));

                    });
                });
            }
        });



    </script>
    <script type="text/javascript">
        function hideloader() {          
                var button = $(this).find('input[type="submit"]');
                setTimeout(function () {
                    button.removeAttr('disabled');
                    $("#imgload").hide();

                }, 1);
        }
        function showloader() {
                var button = $(this).find('input[type="submit"]');
                setTimeout(function () {
                    button.attr('disabled', 'disabled');
                    $("#imgload").show();
                }, 0);
        }
    </script>
</body>
</html>
