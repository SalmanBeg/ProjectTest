@using HRMS.Web.Helper;
@using HRMS.Service.Models.EDM;
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>::: HRMS :::</title>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    @*<link rel="shortcut icon" href="images/favicon.png">*@
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.1/themes/smoothness/jquery-ui.css">
    <script src="//code.jquery.com/ui/1.11.1/jquery-ui.js"></script>
    <!-- bootstrap 3.0.2 -->
    <link href="~/Content/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <!-- font Awesome -->
    <link href="~/Content/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <!-- Ionicons -->
    <link href="~/Content/css/ionicons.min.css" rel="stylesheet" type="text/css" />
    <!-- Morris chart -->
    @*<link href="~/Content/css/morris/morris.css" rel="stylesheet" type="text/css" />*@
    <!-- jvectormap -->
    @*<link href="~/Content/css/jvectormap/jquery-jvectormap-1.2.2.css" rel="stylesheet" type="text/css" />*@





    <!-- Daterange picker -->
    <link href="~/Content/css/daterangepicker/daterangepicker-bs3.css" rel="stylesheet" type="text/css" />
    <!-- Time Picker-->
    <link href="~/Content/css/timepicker/bootstrap-timepicker.css" rel="stylesheet" />
    <!-- bootstrap wysihtml5 - text editor -->
    <link href="~/Content/css/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css" rel="stylesheet" type="text/css" />
    <!-- Theme style -->
    <link href="~/Content/css/AdminLTE.css" rel="stylesheet" type="text/css" />
    @*For Uploading of Files*@
    @* <link href="~/Content/css/uploadfile.css" rel="stylesheet" />*@
    <!-- core css for footable -->
    <link href="~/Content/css/footable/footable.core.css" rel="stylesheet" />

    <!-- customized css for footable -->
    <link href="~/Content/css/footable/footable.metro.css" rel="stylesheet" />
    <!-- Date Picker -->
    @*<link href="../Content/css/datepicker/datepicker.css" rel="stylesheet" />*@
    <link href="~/Content/css/datepicker/datepicker3.css" rel="stylesheet" type="text/css" />

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
          <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
    <!-- jQuery 2.0.2 -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
    <!-- jQuery validation -->
    @Scripts.Render("~/bundles/validate")
    <script src="~/Scripts/plugins/datepicker/bootstrap-datepicker.js"></script>
    <!-- jQuery UI 1.10.3 -->
    <script src="../Scripts/jquery-ui-1.10.3.min.js" type="text/javascript"></script>
    <!-- Bootstrap -->
    <script src="../Scripts/bootstrap.min.js" type="text/javascript"></script>
    <!-- datepicker -->
    <script src="../Scripts/plugins/datepicker/bootstrap-datepicker.js" type="text/javascript"></script>
    <!-- Morris.js charts -->
    @*    <script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
        <script src="../Scripts/plugins/morris/morris.min.js" type="text/javascript"></script>*@
    <!-- Sparkline -->
    <script src="../Scripts/plugins/sparkline/jquery.sparkline.min.js" type="text/javascript"></script>
    <!-- jvectormap -->
    <script src="../Scripts/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js" type="text/javascript"></script>
    <script src="../Scripts/plugins/jvectormap/jquery-jvectormap-world-mill-en.js" type="text/javascript"></script>
    <!-- jQuery Knob Chart -->
    <script src="../Scripts/plugins/jqueryKnob/jquery.knob.js" type="text/javascript"></script>
    <!-- daterangepicker -->
    <script src="../Scripts/plugins/daterangepicker/daterangepicker.js" type="text/javascript"></script>
    <!--Time Picker-->
    <script src="../Scripts/plugins/timepicker/bootstrap-timepicker.js"></script>
    <!-- Bootstrap WYSIHTML5 -->
    <script src="../Scripts/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js" type="text/javascript"></script>
    <!-- iCheck -->
    <script src="../Scripts/plugins/iCheck/icheck.min.js" type="text/javascript"></script>
    <!-- Plug in to add namespace -->
    <script src="../Scripts/HRMS.Plugins.js"></script>
    <!-- AdminLTE App -->
    <script src="../Scripts/AdminLTE/app.js" type="text/javascript"></script>

    <!-- For Uploading of Files-->
    <script src="../Scripts/jquery.uploadfile.min.js"></script>

    <!-- AdminLTE dashboard demo (This is only for demo purposes) -->
    <script src="../Scripts/AdminLTE/dashboard.js" type="text/javascript"></script>

    <!-- AdminLTE for demo purposes -->
    <script src="../Scripts/AdminLTE/demo.js" type="text/javascript"></script>


    <!-- Footable for grid -->
    <script src="../Scripts/plugins/footable/footable.js" type="text/javascript"></script>

    <!-- Footable for pagination in grid -->
    <script src="../Scripts/plugins/footable/footable.paginate.js" type="text/javascript"></script>
    <!-- Footable for sorting in grid -->
    <script src="../Scripts/plugins/footable/footable.sort.js" type="text/javascript"></script>
    <!-- Input masks for controls -->
    <script src="../Scripts/plugins/input-mask/jquery.inputmask.js" type="text/javascript"></script>

    <script src="../Scripts/plugins/input-mask/jquery.inputmask.numeric.extensions.js" type="text/javascript"></script>

    <script src="../Scripts/plugins/input-mask/jquery.inputmask.phone.extensions.js" type="text/javascript"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!-- [if lt IE 9]>-->
    @*  <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>*@
    <!-- <![endif]-->


    <style type="text/css">
        .tooltip-inner {
            max-width: 300px;
            padding: 0;
            background-color: blue;
        }

        .tooltip-alert {
            padding: 8px 10px;
            font-weight: bolder;
            color: #f56954;
        }

        .required:after {
            content: "*";
            font-weight: bold;
            color: red;
        }
    </style>
</head>
<body class="skin-green">
    <!-- header logo: style can be found in header.less -->
    <header class="header">
        <a href="../Home/EmployeeDashboard" class="logo">
            <!-- Add the class icon to your logo image or logo icon to add the margining -->
            <img src="../images/powwowhr%20logo4color_wo_tagline.jpg" style="height:90%;" />
        </a>
        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top" role="navigation">
            <!-- Sidebar toggle button-->
            <a href="#" class="navbar-btn sidebar-toggle" data-toggle="offcanvas" role="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <div class="navbar-right">
                <ul class="nav navbar-nav">
                    <!--Company Announcements -->
                    <li class="dropdown messages-menu">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" id="announcment">
                            <i class="fa fa-bullhorn"></i>
                            <span class="label label-info" id="spnCompanyAnnouncementCount"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li class="header">You have <label id="lblCompanyAnnouncementCount"></label> Company Announcements</li>
                            <li>
                                <!-- inner menu: contains the actual data -->
                                <ul class="menu">
                                    <li>
                                        <!-- start message -->
                                        <div class="pull-left" id="divCompanyQuickAnnouncements">
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            <li class="footer"><a href="@Url.Action("SelectAllCompanyAnnouncement", "CompanyAnnouncement")">See All Announcements</a></li>
                        </ul>
                    </li>
                    <!-- Messages: style can be found in dropdown.less-->
                    <li class="dropdown messages-menu">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-envelope"></i>
                            <span class="label label-info">4</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li class="header">You have 4 messages</li>
                            <li>
                                <!-- inner menu: contains the actual data -->
                                <ul class="menu">
                                    <li>
                                        <!-- start message -->
                                        <a href="#">
                                            <div class="pull-left">
                                                <img src="../images/avatar3.png" class="img-circle" alt="User Image" />

                                            </div>
                                            <h4>
                                                Support Team
                                                <small><i class="fa fa-clock-o"></i>5 mins</small>
                                            </h4>
                                            <p> Why not buy a new awesome theme? </p>
                                        </a>
                                    </li>
                                    <!-- end message -->
                                    <li>
                                        <a href="#">
                                            <div class="pull-left">
                                                <img src="../images/avatar2.png" class="img-circle" alt="user image" />
                                            </div>
                                            <h4>
                                                AdminLTE Design Team
                                                <small><i class="fa fa-clock-o"></i>2 hours</small>
                                            </h4>
                                            <p> Why not buy a new awesome theme? </p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <div class="pull-left">
                                                <img src="../images/avatar.png" class="img-circle" alt="user image" />
                                            </div>
                                            <h4>
                                                Developers
                                                <small><i class="fa fa-clock-o"></i>Today</small>
                                            </h4>
                                            <p> Why not buy a new awesome theme? </p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <div class="pull-left">
                                                <img src="../images/avatar2.png" class="img-circle" alt="user image" />
                                            </div>
                                            <h4>
                                                Sales Department
                                                <small><i class="fa fa-clock-o"></i>Yesterday</small>
                                            </h4>
                                            <p> Why not buy a new awesome theme? </p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <div class="pull-left">
                                                <img src="../images/avatar.png" class="img-circle" alt="user image" />
                                            </div>
                                            <h4>
                                                Reviewers
                                                <small><i class="fa fa-clock-o"></i>2 days</small>
                                            </h4>
                                            <p> Why not buy a new awesome theme? </p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="footer"><a href="#">See All Messages</a></li>
                        </ul>
                    </li>
                    <!-- Notifications: style can be found in dropdown.less -->
                    <li class="dropdown notifications-menu">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-warning"></i>
                            <span class="label label-warning">10</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li class="header"> You have 10 notifications </li>
                            <li>
                                <!-- inner menu: contains the actual data -->
                                <ul class="menu">
                                    <li>
                                        <a href="#">
                                            <i class="ion ion-ios7-people info"></i>5 new members joined today
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <i class="fa fa-warning danger"></i>Very long description here that may not fit into the page and may cause design problems
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <i class="fa fa-users warning"></i>5 new members joined
                                        </a>
                                    </li>

                                    <li>
                                        <a href="#">
                                            <i class="ion ion-ios7-cart success"></i>25 sales made
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <i class="ion ion-ios7-person danger"></i>You changed your username
                                        </a>
                                    </li>
                                    <li id="ReviewNotificationPanel">
                                    </li>
                                </ul>
                            </li>
                            <li class="footer"> <a href="#"> View all </a></li>
                        </ul>
                    </li>
                    <!-- Tasks: style can be found in dropdown.less -->
                    <li class="dropdown tasks-menu" id="usnotification">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-tasks"></i>
                            <span class="label label-danger">9</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li class="header">You have 9 tasks</li>
                            <li>
                                <!-- inner menu: contains the actual data -->
                                <ul class="menu">
                                    <li>
                                        <!-- Task item -->
                                        <a href="#">
                                            <h3>
                                                Design some buttons
                                                <small class="pull-right">20%</small>
                                            </h3>
                                            <div class="progress xs">
                                                <div class="progress-bar progress-bar-aqua" style="width: 20%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                                                    <span class="sr-only">20% Complete</span>
                                                </div>
                                            </div>
                                        </a>
                                    </li>
                                    <!-- end task item -->
                                    <li>
                                        <!-- Task item -->
                                        <a href="#">
                                            <h3>
                                                Create a nice theme
                                                <small class="pull-right">40%</small>
                                            </h3>
                                            <div class="progress xs">
                                                <div class="progress-bar progress-bar-green" style="width: 40%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                                                    <span class="sr-only">40% Complete</span>
                                                </div>
                                            </div>
                                        </a>
                                    </li>
                                    <!-- end task item -->
                                    <li>
                                        <!-- Task item -->
                                        <a href="#">
                                            <h3>
                                                Some task I need to do
                                                <small class="pull-right"> 60% </small>
                                            </h3>
                                            <div class="progress xs">
                                                <div class="progress-bar progress-bar-red" style="width: 60%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                                                    <span class="sr-only">60% Complete</span>
                                                </div>
                                            </div>
                                        </a>
                                    </li>
                                    <!-- end task item -->
                                    <li>
                                        <!-- Task item -->
                                        <a href="#">
                                            <h3>
                                                Make beautiful transitions
                                                <small class="pull-right">80%</small>
                                            </h3>
                                            <div class="progress xs">
                                                <div class="progress-bar progress-bar-yellow" style="width: 80%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                                                    <span class="sr-only">80% Complete</span>
                                                </div>
                                            </div>
                                        </a>
                                    </li>
                                    <!-- end task item -->
                                </ul>
                            </li>
                            <li class="footer">
                                <a href="#">View all tasks</a>
                            </li>
                        </ul>
                    </li>
                    <!-- User Account: style can be found in dropdown.less -->
                    <li class="dropdown user user-menu">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="glyphicon glyphicon-user"></i>
                            <span>@GlobalsVariables.CurrentUserName <i class="caret"></i></span>
                        </a>
                        <ul class="dropdown-menu">
                            <!-- User image -->
                            <li class="user-header bg-light-blue">
                                @if (!string.IsNullOrEmpty(Convert.ToString(GlobalsVariables.EmpImgValue)))
                                { <img src="@GlobalsVariables.EmpImgValue" alt="User image" height="65px" class="img-circle" />}
                                else
                                { <img src="../images/avatar3.png" class="img-circle" />}
                                <p>
                                    @GlobalsVariables.CurrentUserName - @GlobalsVariables.CurrentUserRoleName
                                    <small>Last Login - @GlobalsVariables.LastLogin</small>
                                </p>
                            </li>
                            <!-- Menu Body -->
                            <li>
                                @* <div class="col-xs-4 text-center">
                                        <a href="../Account/UserAccount">Account</a>
                                    </div>
                                     <div class="col-xs-4 text-center">
                                        <a href="#">Sales</a>
                                    </div>
                                    <div class="col-xs-4 text-center">
                                        <a href="#">Friends</a>
                                    </div>*@
                            </li>
                            <!-- Menu Footer-->
                            <li class="user-footer">
                                <div class="pull-left">
                                    <div id="add_image" title="click to add a item"><span class="btn btn-default btn-flat" style="font-size: 13px;">Change Avatar</span></div>
                                    @*<a href="../Account/UserProfile" class="btn btn-default btn-flat">Profile</a>*@
                                </div>
                                <div class="pull-right">
                                    <a href="../Account/Login" class="btn btn-default btn-flat" style="font-weight: bold;">Sign out</a>
                                </div>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <div class="wrapper row-offcanvas row-offcanvas-left">
        <!-- Left side column. contains the logo and sidebar -->
        <aside class="left-side sidebar-offcanvas">
            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">
                <!-- Sidebar user panel -->
                <div class="user-panel">
                    <div class="pull-left image">
                        @if (!string.IsNullOrEmpty(Convert.ToString(GlobalsVariables.EmpImgValue)))
                        { <img src="@GlobalsVariables.EmpImgValue" alt="User image" height="65px" class="img-circle" />}
                        else
                        { <img src="../images/avatar3.png" class="img-circle" />}
                    </div>
                    <div class="pull-left info">
                        <p>Hello, @GlobalsVariables.CurrentUserName</p>

                        <a href="#"><i class="fa fa-circle text-success"></i> Online </a>
                    </div>
                </div>
                <!-- search form -->
                <form action="#" method="get" class="sidebar-form">
                    <div class="input-group">
                        <select class="form-control" id="drpemployees" style="width: 200px;"></select>
                        @* <span class="input-group-btn">
                                <button type='submit' name='seach' id='search-btn' class="btn btn-flat"><i class="fa fa-search"></i></button>
                            </span>*@
                    </div>
                </form>
                @if (GlobalsVariables.CurrentUserRoleName.Equals(HRMS.Common.Enums.GeneralEnum.RoleName.Superadministrator.ToString().ToLower()))
                {
                    <form action="#" method="get" class="sidebar-form">
                        <div class="input-group">
                            <select class="form-control" id="drpcompanies" style="width: 200px;"></select>
                        </div>
                    </form>
                }

                <!-- /.search form -->
                <!-- sidebar menu: : style can be found in sidebar.less -->

                <ul id="sidemenubar" class="sidebar-menu"></ul>




            </section>
            <!-- /.sidebar -->
        </aside>

        <!-- Right side column. Contains the navbar and content of the page -->
        <aside class="right-side">
            <!-- Content Header (Page header) -->
            <section class="content-header" id="header-section">
                @* <h1>Dashboard
                        <small>Control panel</small>
                    </h1>
                    <ol class="breadcrumb">
                        <li><a href="#"><i class="fa fa-dashboard"></i>Home</a></li>
                        <li class="active">Dashboard</li>
                    </ol>*@
            </section>

            <!-- Main content -->
            <section class="content">

                @RenderBody()

                @*@Scripts.Render("~/bundles/jquery")*@
                @RenderSection("scripts", required: false)
            </section>
        </aside>
    </div>

    <!-- show document dialog-->
    <div class="modal fade modal-fullscreen" id="ViewimageUploadDialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="margin-top: 150px; width: 50%;height:40%; margin-left:auto; margin-right:auto;background-color:white;">
        <div class=" modal-lg" style="width: 100%">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="">&times;</button>
            </div>
            <div class="modal-body" style="height: 150px;background-color:white;">
                <!--Form for adding documents-->
                <div id="add_image_area" style="display: none;">
                    <div id="add_document_instructions">
                        Only files of format (.jpg,.gif,.png,.bmp) are allowed...
                    </div>
                    <div id="document_file_button_wrapper" style="width: 100%;">
                        <span class="btn btn-default btn-flat">
                            Select Avatar
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Announcement dialog-->
    <div id="announcement">
        <div class="modal fade modal-fullscreen" id="divComapnyAnnouncementDialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="margin-top: 150px; width: 60%;height:40%; margin-left:auto; margin-right:auto; background-color:white; ">
            <div class="modal-dialog modal-lg" style="width: 100%">
                <div class="modal-header" id="divAccouncementHeader">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body" style=" background-color: white; overflow: scroll; height:250px; width:100%;">
                    <div id="add_image_area" style="display:block;">
                        <div id="add_companyaccouncement_instructions">
                            <h2 id="companyannouncementtite"></h2>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add New dialog-->
    <div class="modal fade" id="addNewModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Add New Item</h4>
                </div>

                <div class="modal-body">
                    <!-- The form is placed inside the body of modal -->
                    <form id="loginForm" method="post" class="form-horizontal">
                        <div class="form-group">
                            <label class="col-sm-3 control-label">Name</label>
                            <div class="col-sm-5">
                                <input type="text" class="form-control" id="txtname" name="Name" />
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label">Description</label>
                            <div class="col-sm-5">
                                <input type="text" class="form-control" id="txtdescription" name="Description" />
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-sm-5 col-sm-offset-3">
                                <button type="submit" id="btnSaveNewItem" class="btn btn-default">Save</button>
                                <input type="hidden" id="hdnTableValue" value="" />
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
            var baseurl = '@System.Configuration.ConfigurationManager.AppSettings["BaseURL"]';
            // to load menu for the applicaiton

            LoadNotification();

            LoadMenu(baseurl + "CompanyLevelSecurity/_CompanyMenuView", "", "GET");
            //to fill company announcements
            //getAllQuickCompanyAnnouncements();

            //to fill companies
            if ('@GlobalsVariables.CurrentUserRoleName.ToLower()' == 'superadministrator')
                LoadCompanies();

            //for loading wait gif image
            $(document).on('invalid-form.validate', 'form', function () {
                var button = $(this).find('input[type="submit"]');
                setTimeout(function () {
                    button.removeAttr('disabled');
                    $("#imgload").hide();

                }, 1);
            });
            $(document).on('submit', 'form', function () {
                var button = $(this).find('input[type="submit"]');
                setTimeout(function () {
                    button.attr('disabled', 'disabled');
                    $("#imgload").show();
                }, 0);
            });


            $(".fa-gear").parent().css("display", "none");
            //to load all employees related to logged in company
            LoadEmployees();
            //for grid layout and responsive using footable
            $('.footable').footable();
            //for datepicker using bootstrap
          
            $(".datepicker-trigger").on("click", function () {
                debugger;
              
                $(".dateControl").datepicker("show");
                //$(".dateControl").datepicker({ todayHighlight: true });
            });
           
            //Timepicker
            $(".timepicker").timepicker({
                showInputs: false
            });


            //$(".phonemask").mask("(999) 999-9999");

            // for validations using tooltip
            var classes = { groupIdentifier: ".form-group", error: 'has-error', success: null };//success: 'has-success'
            function updateClasses(inputElement, toAdd, toRemove) {
                var group = inputElement.closest(classes.groupIdentifier);
                if (group.length > 0) {
                    group.addClass(toAdd).removeClass(toRemove);
                }
            }
            function onError(inputElement, message) {
                updateClasses(inputElement, classes.error, classes.success);

                var options = { html: true, title: '<div class="tooltip-alert alert-danger">' + message + '</div>' };
                inputElement.tooltip("destroy")
                    .addClass("error")
                    .tooltip(options);
            }
            function onSuccess(inputElement) {
                updateClasses(inputElement, classes.success, classes.error);
                inputElement.tooltip("destroy");
            }

            function onValidated(errorMap, errorList) {
                $.each(errorList, function () {
                    onError($(this.element), this.message);
                });

                if (this.settings.success) {
                    $.each(this.successList, function () {
                        onSuccess($(this));
                    });
                }
            }

            $(function () {
                $('form').each(function () {
                    var validator = $(this).data('validator');
                    if (validator != null)
                        validator.settings.showErrors = onValidated;
                });
            });
            $("#ViewimageUploadDialog").modal('hide');


            $('#add_image').click(function (e) {
                e.preventDefault();
                e.stopPropagation();
                OpenImageArea();
                UploadImage();
                return false;
            });

            //highlight today date.........
            $(".dateControl").datepicker({
                autoclose: true,
                todayHighlight: true             
            });



            //To save a new item for lookup tables
            $("#btnSaveNewItem").click(function (e) {

                e.stopPropagation();
                e.preventDefault();
                var baseurl = '@System.Configuration.ConfigurationManager.AppSettings["BaseURL"]';
                var tableName = $("#hdnTableValue").val();
                var name;
                var description;
                var companyId;
                var args = "";
                var url = "";

                if (tableName.indexOf("Utility") >= 0) {
                    name = $("#txtname")[0].value;
                    description = $("#txtdescription")[0].value;
                    if (name.trim() == "") {
                        alert("Please enter Name");
                        return false;
                    }
                    if (description.trim() == "") {
                        alert("Please enter Description");
                        return false;
                    }
                    companyId = '@GlobalsVariables.CurrentCompanyId';
                    args = { TableName: tableName, Name: name, Description: description, CompanyId: companyId };
                    url = baseurl + "LookUpData/AddLookUpPartialView";
                }
                else if (tableName.indexOf("JobProfile") >= 0) {
                    name = $("#txtname")[0].value;
                    description = $("#txtdescription")[0].value;
                    if (name.trim() == "") {
                        alert("Please enter Name");
                        return false;
                    }
                    if (description.trim() == "") {
                        alert("Please enter Description");
                        return false;
                    }
                    companyId = '@GlobalsVariables.CurrentCompanyId';
                    args = { Title: name, JobDescription: description };
                    url = baseurl + "JobProfile/AddJobProfileAsync";
                }

                SaveLookUpData(url, args, "POST");

            });



            //applying masks to controls

            $(".phonemask").inputmask("mask", { "mask": "(999) 999-9999" });
            $(".ssnmask").inputmask("mask", { "mask": "999-99-9999" });
            $(".zipmask").inputmask({ mask: "99999[-9999]", greedy: false });

        });
        function LoadEmployees() {

            var companyId = '@HRMS.Web.Helper.GlobalsVariables.CurrentCompanyId';
            if (companyId != null && companyId != "") {
                var baseurl = '@System.Configuration.ConfigurationManager.AppSettings["BaseURL"]';
                varContentType = "application/json; charset=utf-8";
                varDataType = "json";
                varProcessData = false;
                $.ajax({
                    type: "GET", //GET or POST or PUT or DELETE verb
                    url: baseurl + "Home/FillEmployeeListByCompanyIdAndRoleId", // Location of the service
                    data: { companyId: companyId }, //Data sent to server
                    contentType: varContentType, // content type sent to server
                    dataType: varDataType, //Expected data format from server
                    processdata: varProcessData, //True or False
                    cache: false,
                    success: function (employeeData) {//On Successfull service call
                        if (employeeData != null) {
                            var select = $('#drpemployees');
                            select.html('');
                            $.each(employeeData, function (index, itemData) {
                                select.append($('<option/>', {
                                    value: itemData.UserId,
                                    text: itemData.FirstName + ' ' + itemData.LastName,
                                }));
                            });
                            select.val('@GlobalsVariables.SelectedUserId');
                        }
                    },
                    error: function (msg) {
                        alert(msg.statusText);
                        varType = null; varUrl = null; varContentType = null; varDataType = null; varProcessData = null;
                    } // When Service call fails
                });
            }
        }
        $("#drpemployees").change(function () {
            var selectedEmployeeid = $(this).val();

            var baseurl = '@System.Configuration.ConfigurationManager.AppSettings["BaseURL"]';

            $.ajax({
                url: baseurl + "Account/SelectUser",
                type: "Post",
                data: { "userId": selectedEmployeeid },
                success: function (data) {
                    window.location.href = baseurl + "Home/EmployeeDashBoard";
                }
            });
        });


        function LoadCompanies() {

            var companyId = '@HRMS.Web.Helper.GlobalsVariables.CurrentCompanyId';
            if (companyId != null && companyId != "") {
                var baseurl = '@System.Configuration.ConfigurationManager.AppSettings["BaseURL"]';
                var varContentType = "application/json; charset=utf-8";
                varDataType = "json";
                varProcessData = false;
                $.ajax({
                    type: "GET", //GET or POST or PUT or DELETE verb
                    url: baseurl + "Company/SelectAllCompanies", // Location of the service
                    data: "", //Data sent to server
                    contentType: varContentType, // content type sent to server
                    dataType: varDataType, //Expected data format from server
                    processdata: varProcessData, //True or False
                    cache: false,
                    success: function (companyData) {//On Successfull service call
                        if (companyData != null) {
                            var select = $('#drpcompanies');
                            select.html('');
                            $.each(companyData, function (index, itemData) {
                                select.append($('<option/>', {
                                    value: itemData.CompanyId,
                                    text: itemData.CompanyName,
                                }));
                            });
                            select.val('@GlobalsVariables.CurrentCompanyId');
                        }
                    },
                    error: function (msg) {
                        alert(msg.statusText);
                        varType = null; varUrl = null; varContentType = null; varDataType = null; varProcessData = null;
                    } // When Service call fails
                });
            }
        }
        $("#drpcompanies").change(function () {

            var selectedCompanyid = $(this).val();
            var baseurl = '@System.Configuration.ConfigurationManager.AppSettings["BaseURL"]';
            $.ajax({
                url: baseurl + "Company/SelectCompanyInfo",
                type: "Post",
                data: { "companyId": selectedCompanyid },
                success: function (data) {
                    window.location.href = baseurl + "Home/EmployeeDashBoard";
                }
            });
        });



        $(document).mouseup(function (e) {
            var divs = $('.navbar-collapse');
            var btn = e.target.id;
            if (divs.length != 0) {
                if (!divs.is(e.target) && divs.has(e.target).length === 0 && divs[0].classList.length == 3 && btn != 'dashboard-gear') {
                    divs.removeClass('in');
                }
            }

        });//end of mouse up
        var OpenImageArea = function () {
            //hide other areas
            $('#ViewimageUploadDialog').modal();
            if ($("#add_image_area").is(":visible")) {
                $("#add_image_area").toggle();
            }
            else {
                $("#add_image_area").show();
            }
        }

        function UploadImage() {
            var baseurl = '@System.Configuration.ConfigurationManager.AppSettings["BaseURL"]';
            $("#document_file_button_wrapper").uploadFile({
                url: baseurl + 'Home/UploadEmployeePhoto',
                allowedTypes: "pdf,jpg,gif,png,bmp",
                multiple: true,
                autoSubmit: true,
                maxFileSize: 5287590,
                showAbort: false,
                showDone: false,
                onSelect: function (files) {
                    files[0].name;
                    files[0].size;
                    if (files[0].size > 5287590) { // 5mb
                        alert("Cannot upload file greater than 5mb.");
                        return false;
                    } else
                        return true; //to allow file submission.
                },
                onSuccess: function (files, data, xhr, pd) {
                    $("#add_image_area").hide();
                    $.ajax({
                        url: baseurl + "Home/SelectEmployeePhotoByUserId",
                        type: "Post",
                        data: {},
                        success: function (data) {
                            window.location.href = baseurl + "Home/EmployeeDashBoard";
                        }
                    });
                },
                onError: function (files, status, errMsg, pd) {
                    errMsg: "file size exceeded."
                }
            });
        }


        var LoadMenu = function (url, args, type) {
            $.ajax({
                url: url,
                type: type,
                cache: false,
                data: args,
                success: function (data) {
                    $("#sidemenubar").append(data);
                    getAllQuickCompanyAnnouncements();


                },
                error: function (request, status, error) {
                    alert(request.responseText);
                }
            });
        }
        //to enable the modal dialog to add a new item to dropdown
        $(".drplookup").change(function () {
            if ($(this).val() == "0") {
                var tablevalue = $(this).attr('data-val-1');
                $("#hdnTableValue").val(tablevalue);
                $("#addNewModal").modal("show");

            }
        });
        // to save dropdown values for lookup data from dropdownlists
        var SaveLookUpData = function (url, args, type) {
            $.ajax({
                url: url,
                type: type,
                cache: false,
                data: args,
                success: function (data) {
                    //nide the add new modal and refresh the view
                    window.location.href = window.location.href;
                    $("#addNewModal").modal("hide");
                },
                error: function (request, status, error) {
                    alert(request.responseText);
                }
            });
        }

        var LoadNotification = function (url, args, type) {
            $.ajax({
                url: url,
                type: type,
                cache: false,
                data: args,
                success: function (data) {
                    $("#reviewName").append(data);
                    getAllReviewNotification();
                },
                error: function (request, status, error) {
                    alert(request.responseText);
                }
            });
        }

        @*Company Announcements*@
        function getAllQuickCompanyAnnouncements() {
            var baseurl = '@System.Configuration.ConfigurationManager.AppSettings["BaseURL"]';
            $("#UpdatePanel").html("<div style='text-align:center; background-color:yellow; border:1px solid red; padding:3px; width:200px'>Please Wait...</div>");
            $.ajax({
                type: "GET",
                url: baseurl + "CompanyAnnouncement/SelectAllQuickCompanyAnnouncement",
                data: "{}",
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: OnSuccess,
                error: OnError
            });
        }
        var OnSuccess = function (data) {
            //alert("Success: "+ data[0].Message);
            var TableContent = "<table border='0' style='color: black;'>";
            $("#spnCompanyAnnouncementCount").html(data.length);
            $("#lblCompanyAnnouncementCount").text(data.length);
            for (var i = 0; i < data.length; i++) {
                var creationdate = data[i].CreatedDate;
                creationdate = new Date(parseInt(creationdate.replace(/\/Date\((.*?)\)\//gi, "$1")));
                creationdate = creationdate.toLocaleDateString();
                //alert(creationdate);
                TableContent += "<tr>" +
                    "<a href='#'>" +
                    @*"<a href='@Url.Action("AddCompanyAnnouncement", "CompanyAnnouncement", new { CompanyAnnouncementId = data[i].CompanyAnnouncementId})'>" +*@
                    @*"<a href='@Url.Action("AddCompanyAnnouncement", "CompanyAnnouncement")' onclick='showAnnouncement('" + data[i].CompanyAnnouncementId + "');'>" +*@
                    "<td>" +
                    "<h4>" + creationdate + "</h4>" +
                    "<h5><a href='#' style='color:blue' onclick='javascript:showMessage(" + data[i].CompanyAnnouncementId + ");'>" + data[i].Title + "</a></h5>" +
                    "</td>" +
                    "</a>" +
                    "</tr>";
            }
            TableContent += "</table>";
            $("#divCompanyQuickAnnouncements").html(TableContent);
        }
        var OnError = function (data) {
            alert("Error: " + data);
        }
        var showAnnouncement = function (companyAnnouncementId) {
            var baseurl = '@System.Configuration.ConfigurationManager.AppSettings["BaseURL"]';
            window.location.href = baseurl + "AddCompanyAnnouncement/CompanyAnnouncement?CompanyAnnouncementId=" + companyAnnouncementId;
        }

        function showMessage(companyAnnouncementId) {

            //alert(companyAnnouncementId);
            var baseurl = '@System.Configuration.ConfigurationManager.AppSettings["BaseURL"]';
            $.ajax({
                type: "GET",
                url: baseurl + "CompanyAnnouncement/SelectQuickCompanyAnnouncement",
                data: { CompanyAnnouncementId: companyAnnouncementId },
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: OnSuccess,
                error: OnError
            });

            function OnSuccess(data) {
                //alert(data[0].Message);
                //$("#divAccouncementHeader").html(data[0].Title);
                $("#add_companyaccouncement_instructions").html("<h4>" + data[0].Title + "</h4>");
                $("#add_companyaccouncement_instructions").append(data[0].Message) + "<br><br>";
                $("#add_companyaccouncement_instructions").append("Thank you for visiting the Company Announcement.");
                $("#divComapnyAnnouncementDialog").modal();
            }
        }

        //--------------------------  for displaying Review Name at Notification..............
        function getAllReviewNotification() {
            var baseurl = '@System.Configuration.ConfigurationManager.AppSettings["BaseURL"]';
            $.ajax({
                type: "GET",
                url: baseurl + "PerformanceReview/GetReviewNotifications",
                data: "{}",
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: OnSuccessNotifiactions,
                error: OnError
            });
        }
        var OnSuccessNotifiactions = function (data) {
            //alert("Success: "+ data[0].Message);
            var TableContent = "<table border='0' style='color: black;'>";
            for (var i = 0; i < data.length; i++) {
                TableContent += "<tr>" +
                   // "<a href='../PerformanceReview/Form"ReviewForm?ReviewerEmployeeId=1
                   "<a href='../ReviewForm/ReviewForm?ReviewId=" + data[i].ReviewId + "' style='color:blue'>" +
                   //  "<a href='../ReviewForm/ReviewForm=" + data[i].ReviewId + "' style='color:blue'>" +
                     "<i class='ion ion-ios7-person danger'></i>" + data[i].ReviewName + "</a>" +
                    "</tr>";
            }
            TableContent += "</table>";
            $("#ReviewNotificationPanel").html(TableContent);
        }
        var OnError = function (data) {
            alert("Error: " + data);
        }

        function getAllReviewNotification() {

            var baseurl = '@System.Configuration.ConfigurationManager.AppSettings["BaseURL"]';
            $.ajax({
                url: baseurl + "PerformanceReview/GetReviewNotifications",
                type: "POST",
                cache: "false",
                data: { ReviewIds: '1' },
                success: function (data) {
                    if (data.length > 0) {
                        OnSuccessNotifiactions(data);
                    }

                },
                error: function (request, status, error) {
                    alert(request.responseText);
                }
            });
        }
        // function to serialize the form to json format
        $.fn.serializeObject = function () {
            var o = {};
            var a = this.serializeArray();
            $.each(a, function () {
                if (o[this.name] !== undefined) {
                    if (!o[this.name].push) {
                        o[this.name] = [o[this.name]];
                    }
                    o[this.name].push(this.value || '');
                } else {
                    o[this.name] = this.value || '';
                }
            });
            return o;
        };
    </script>

</body>
</html>
